# Insyd MLOps

This repository contains a machine learning model pipeline for predicting property prices. The pipeline leverages various tools and frameworks, including Metaflow, MLflow, and FastAPI, to streamline the machine learning workflow from data ingestion to model deployment.

## Table of Contents

- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Running the Application](#running-the-application)
- [API Endpoints](#api-endpoints)

## Prerequisites

Before you begin, ensure you have met the following requirements:

- Python 3.12.4 or later
- pip (Python package installer)
- Access to a cloud storage solution (e.g., Google Cloud Storage) if using cloud-based features
- Mlflow setup in GCP/local
- Metaflow setup in GCP/local

## Installation

1. Clone this repository:

   git clone https://github.com/Tatshini/insyd_mlops.git
   cd insyd_mlops

2. Create and activate a virtual environment:

    python -m venv venv
    source venv/bin/activate 

3. Install the required packages:

    pip install -r requirements.txt

## Running the Application

1. Change the link to mlflow in model_training_metaflow.py
2. Run python src/model_training_metaflow.py
3. Now that the model is selected and stored in mlflow using metaflow pipeline, we can run the app.
4. Change the link to mlflow in src/app.py
5. Run app with the command, uvicorn src.app:app --reload
6. You can also test the app using src/test_app.py or by using the swagger doc generated by fastapi: http://localhost:8000/docs


## API Endpoints
Predict Price
URL: /predict

Method: POST

Request Body:
    {
    "title": "Piso Carrer de llull. Piso con 4 habitaciones con ascensor y calefacción",
    "loc_string": "Barcelona - El Parc i la Llacuna del Poblenou",
    "loc": "None",
    "features": ["87 m2", "4 hab.", "1 baño"],
    "description": "Contactar con Camila...",
    "type": "FLAT",
    "subtype": "FLAT",
    "selltype": "SECOND_HAND",
    "desc": "Contactar con Camila...",
    "id": 0
    }

Response:
    {
    "prediction": predicted_price,
    "file_path": "solution.csv"
    }

